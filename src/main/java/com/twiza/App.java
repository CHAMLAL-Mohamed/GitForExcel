/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package com.twiza;

import com.twiza.excel.EBuilder;
import com.twiza.excel.ERow;
import com.twiza.excel.ExcelBuilder;
import com.twiza.excel.ExcelFile;
import org.apache.poi.ss.usermodel.Workbook;

import java.io.IOException;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

public class App {


    static int[] indexes = new int[]{0, 1};
    static EBuilder builder;
    static final String ROOT = "C:\\data\\TestFiles\\";
    static final String PATH = ROOT + "test1.xlsx";
    static final String PATH1 = ROOT + "test2.xlsx";

    static final int INDEX = 0;

    public static void main(String[] args) throws IOException {
        builder = ExcelBuilder.getInstance();
        Workbook workbook = builder.buildWorkbook(PATH);
        ExcelFile excelFile = new ExcelFile();
        Workbook workbook1 = builder.buildWorkbook(PATH1);
        ExcelFile excelFile1 = new ExcelFile();

        for (int i = 0; i < indexes.length; ++i) {
            excelFile.AddSheet(builder.buildESheet(workbook, indexes[i]));
            excelFile1.AddSheet(builder.buildESheet(workbook1, indexes[i]));
        }
        excelFile1.compare(excelFile);
//        try {
//            Map map = excelFile1.compare(excelFile).getSheetData(workbook.getSheetName(indexes[0]));
//            //   excelFile.getSheetData(workbook.getSheetName(indexes[0]));
//            System.out.println("-----------------------Print Sheet1--------------------------");
//            printMap(map);
//        } catch (NullPointerException var5) {
//            System.out.println(" the ExcelFile doesn't contain this sheet");
//        } catch (IllegalArgumentException var6) {
//            System.out.println("No sheet at that Index");
//        }

    }

    private static void printMap(Map<String, ERow> map) {
        Iterator rows = map.keySet().iterator();

        while (rows.hasNext()) {
            String key = (String) rows.next();
            System.out.print(key + " :");
            Iterator rowsElemets = ((List) map.get(key).getElements()).iterator();

            while (rowsElemets.hasNext()) {
                String value = (String) rowsElemets.next();
                System.out.print(value + "-");
            }

            System.out.println();
        }

    }
}
